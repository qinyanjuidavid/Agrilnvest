{%extends 'accounts/try.html'%} {%load static%} {%load crispy_forms_tags%}
{%block title%} Add Product {%endblock%} {%block content%}
<div class="container">
  <div class="row mt-3">
    <div class="col-sm-9">
      <div class="col-md-12 p-3 bg-white mb-3 text-left">
        <legend class="mr-2">
          <i><b class="text-info">Add</b></i> Product
        </legend>

        <form
          action="."
          class="bg-white"
          method="POST"
          enctype="multipart/form-data"
        >
          {%csrf_token%}
          <div class="row">
            <div class="col-sm-6"></div>
            <div class="col-sm-6"></div>
          </div>
          <button type="submit" class="btn btn-outline-success">
            Add Product
          </button>
        </form>
      </div>
    </div>

    <div class="col-sm-3 text-left">
      <div class="p-4 mb-3 bg-white">
        <div class="row">
          <div class="col-sm-4">
            <img src="" height="70px" width="70px" alt="" />
          </div>
          <div class="col-sm-8">
            <b></b>
            <div class="ml-1 mt-2"></div>
          </div>
        </div>
        <hr />
        <h3 class="h5 text-black mb-3">Contact Info</h3>
        <p class="mb-0 font-weight-bold">Address</p>
        <p class="mb-4"></p>
        <p class="mb-0 font-weight-bold">Phone</p>
        <p class="mb-4"></p>

        <p class="mb-0 font-weight-bold">Email Address</p>
        <p class="mb-0"></p>
      </div>
      <div class="p-4 mb-3 bg-white">
        <h3 class="h5 text-black mb-3">More Info</h3>
        <p></p>
        <p href="#" class="btn btn-primary py-2 px-4">Learn More</p>
      </div>
    </div>
  </div>
</div>
{%endblock%} {% block javascript %}
<script>
  var category = document.getElementById("id_category");
  var itemElement = document.getElementById("id_item");

  // listen to change event
  function updateProducts() {
    // clear products items
    itemElement.innerHTML = "";

    // get the value
    let categoryValue = category.value;

    // get the respective product for each category
    $.ajax({
      url: "",
      data: { category: categoryValue },
      type: "GET",
      success: function (response) {
        // update the
        let items = JSON.parse(response);
        console.log(items);

        // update product options
        items.products.forEach((item) => {
          let option =
            "<option value='" + item.pk + "'>" + item.name + "</option>";
          itemElement.innerHTML += option;
        });
      },
      error: function (error) {
        console.error(error);
      },
    });
  }

  updateProducts();
</script>
{% endblock %}
